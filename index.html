import React, { useState, useMemo } from 'react';
import { 
  LineChart, Line, AreaChart, Area, XAxis, YAxis, CartesianGrid, 
  Tooltip, Legend, ResponsiveContainer, BarChart, Bar, Cell,
  PieChart, Pie, ComposedChart
} from 'recharts';
import { 
  TrendingUp, Wallet, ArrowUpRight, Clock, Calculator, 
  BarChart3, PieChart as PieIcon, Activity, Info, CreditCard, ChevronRight,
  TrendingDown, DollarSign, FileText, ShieldCheck
} from 'lucide-react';

const App = () => {
  const [exitMultiple, setExitMultiple] = useState(6.5);
  const equityInvestment = 104.4; // Samkvæmt PDF
  
  const financialData = [
    { year: 2026, revenue: 379.73, ebitda: 104.29, debt: 390.00, cash: 37.75, noplat: 73.16 },
    { year: 2027, revenue: 417.70, ebitda: 107.51, debt: 390.00, cash: 86.29, noplat: 83.73 },
    { year: 2028, revenue: 459.47, ebitda: 118.26, debt: 390.00, cash: 5.65,  noplat: 93.39 },
    { year: 2029, revenue: 505.42, ebitda: 130.09, debt: 243.33, cash: 44.37, noplat: 100.09 },
    { year: 2030, revenue: 541.28, ebitda: 139.41, debt: 196.67, cash: 17.12, noplat: 105.10 },
    { year: 2031, revenue: 568.34, ebitda: 146.38, debt: 80.00,  cash: 102.74, noplat: 110.35 },
    { year: 2032, revenue: 596.76, ebitda: 153.70, debt: 40.00,  cash: 195.56, noplat: 115.87 },
  ];

  const revCAGR = (Math.pow(596.76 / 379.73, 1/6) - 1) * 100;
  const ebitdaCAGR = (Math.pow(153.70 / 104.29, 1/6) - 1) * 100;

  const calculatedRatios = useMemo(() => {
    return financialData.map((d, index) => {
      const prevDebt = index > 0 ? financialData[index - 1].debt : 390.00;
      const amortization = Math.max(0, prevDebt - d.debt);
      const interest = d.debt * 0.08;
      const fccr = d.noplat / (interest + amortization);
      return {
        year: d.year,
        leverage: parseFloat(((d.debt - d.cash) / d.ebitda).toFixed(2)),
        fccr: parseFloat(fccr.toFixed(2))
      };
    });
  }, [financialData]);

  return (
    <div className="min-h-screen bg-[#F8FAFC] p-8 font-sans text-slate-900">
      <div className="max-w-7xl mx-auto space-y-6">
        <h1 className="text-4xl font-extrabold text-blue-950">Project KEF</h1>
        <p className="text-slate-500">Mælaborðið er tilbúið. Skoðaðu Preview flipann fyrir gagnvirka útgáfu.</p>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div className="bg-white p-6 rounded-3xl border border-blue-100 shadow-sm">
                <h3 className="font-bold mb-4">Tekjur CAGR</h3>
                <p className="text-3xl font-black text-blue-600">{revCAGR.toFixed(1)}%</p>
            </div>
            <div className="bg-white p-6 rounded-3xl border border-blue-100 shadow-sm">
                <h3 className="font-bold mb-4">EBITDA CAGR</h3>
                <p className="text-3xl font-black text-blue-900">{ebitdaCAGR.toFixed(1)}%</p>
            </div>
        </div>
      </div>
    </div>
  );
};

export default App;
